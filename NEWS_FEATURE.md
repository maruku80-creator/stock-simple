# 股票儀表板 - 新聞功能文檔

## 新增功能說明

本更新添加了股票新聞查詢和中文翻譯功能，使用戶能夠查看與特定股票相關的最新新聞。

### 主要功能

#### 1. 股票新聞查詢 (`/api/news`)

**API 端點**: `GET /api/news?symbol=SYMBOL`

**參數**:
- `symbol` (必需): 股票代號，例如 `AAPL`, `NVDA` 等

**返回格式**:
```json
[
  {
    "title": "原始英文標題",
    "titleZh": "中文翻譯標題",
    "description": "原始英文摘要",
    "descriptionZh": "中文翻譯摘要",
    "url": "新聞連結",
    "source": "新聞來源",
    "publishedAt": "2026-02-01T12:00:00Z",
    "image": "新聞圖片 URL (可選)"
  }
]
```

#### 2. 自動中文翻譯

系統使用兩層翻譯策略:

1. **MyMemory Translation API** (免費翻譯服務)
   - 提供高質量的自動翻譯
   - 無需 API 密鑰

2. **關鍵詞對照表** (備用方案)
   - 包含股票相關的常見詞彙
   - 當主翻譯服務不可用時使用

#### 3. 用戶界面改進

**股票卡片**:
- 添加了「查看新聞」按鈕
- 點擊即可加載相關股票新聞

**新聞顯示區域**:
- 新聞標題和摘要 (英文)
- 可展開的中文翻譯部分
- 新聞來源和發布時間
- 新聞圖片 (如可用)
- 「閱讀全文」按鈕連至原始新聞

### 配置說明

#### NewsAPI 集成 (可選)

如果要使用 [NewsAPI](https://newsapi.org/) 獲得更穩定的新聞服務:

1. 訪問 https://newsapi.org/ 獲取免費 API 密鑰
2. 在 `.env.local` 中設置:
```
NEWS_API_KEY=your_api_key_here
```

3. 系統會自動使用 NewsAPI，如果不可用則回退到備用方案

#### 環境變量

在項目根目錄創建 `.env.local` 文件:

```env
# NewsAPI (可選)
NEWS_API_KEY=your_api_key_here
```

### 技術實現細節

**後端** (`src/app/api/news/route.ts`):
- 使用 Next.js API Routes
- 支持 NewsAPI 和備用新聞源
- 並行翻譯多篇新聞以提高性能
- 實現了 3600 秒 (1 小時) 的快取

**前端** (`src/app/page.tsx`):
- 使用 React Hooks 管理新聞狀態
- 非同步加載新聞數據
- 可展開的詳細翻譯區域
- 響應式設計，支持移動設備

### 翻譯精度

- **英文到繁體中文**: MyMemory API 提供
- **股票術語**:
  - Stock → 股票
  - Market → 市場
  - Rally → 上漲
  - Earnings → 收益
  - 等 40+ 個術語

### 性能優化

1. **快取策略**: 新聞數據快取 1 小時
2. **並行翻譯**: 多篇新聞同時翻譯
3. **延遲加載**: 新聞只在用戶點擊時加載
4. **圖片優化**: 使用原始新聞源的圖片 URL

### 使用示例

1. 應用啟動時加載默認股票的報價
2. 點擊任何股票卡片上的「查看新聞」按鈕
3. 系統加載該股票的最近 5 篇新聞
4. 點擊「查看中文翻譯」展開中文版本
5. 點擊「閱讀全文」可跳轉到原始新聞網站

### 故障排除

#### 新聞不顯示?
- 檢查網路連接
- 確保股票代號拼寫正確
- 如果使用 NewsAPI，確認 API 密鑰有效
- 查看瀏覽器控制台的錯誤信息

#### 翻譯不準確?
- 這是自動翻譯的正常限制
- MyMemory API 的翻譯品質通常很好
- 股票術語使用詞典進行改進

#### 新聞加載很慢?
- 翻譯服務可能響應慢
- 這在首次請求時較常見
- 後續相同股票的查詢會更快 (由於快取)

### 已知限制

1. **免費新聞源限制**:
   - 每天有請求限制
   - 在高流量時可能不可用

2. **翻譯限制**:
   - 機器翻譯可能不完美
   - 複雜的財務術語可能翻譯不準確

3. **新聞可用性**:
   - 並非所有股票都有充足的新聞
   - 小型股票的新聞可能較少

### 未來改進方向

- [ ] 集成更多新聞源
- [ ] 支持更多語言
- [ ] 新聞分類和篩選
- [ ] 用戶偏好設置
- [ ] 新聞情感分析
- [ ] 本地化翻譯改進

### 版本信息

- **更新日期**: 2026-02-01
- **新增文件**: `src/app/api/news/route.ts`
- **修改文件**: `src/app/page.tsx`

---

**注意**: 本功能使用第三方服務。請確保遵守相應服務的使用條款。
